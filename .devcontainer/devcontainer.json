{
  "build": {
    "context": ".",
    "dockerfile": "./Dockerfile",
    "args": {
      "CUDA": "11.8",
      "LLVM": "15"
    }
  },

  "capAdd": [
    "SYS_PTRACE"
  ],
  "securityOpt": [
    "seccomp=unconfined"
  ],
  "hostRequirements": {
    "gpu": true
  },

  "initializeCommand": "mkdir -p ../.aws ../.cache ../.conda ../.config ../rmm ../cudf",

  "containerEnv": {
    "DEFAULT_CONDA_ENV": "cuspatial",
    "PYTHONDONTWRITEBYTECODE": "1",
    "VAULT_HOST": "https://vault.ops.k8s.rapids.ai"
  },

  "workspaceFolder": "/home/coder",
  "workspaceMount": "source=${localWorkspaceFolder},target=/home/coder/cuspatial,type=bind",
  "mounts": [
    {
      "type": "bind",
      "target": "/home/coder/.aws",
      "source": "${localWorkspaceFolder}/../.aws"
    },
    {
      "type": "bind",
      "target": "/home/coder/.cache",
      "source": "${localWorkspaceFolder}/../.cache"
    },
    {
      "type": "bind",
      "target": "/home/coder/.conda",
      "source": "${localWorkspaceFolder}/../.conda"
    },
    {
      "type": "bind",
      "target": "/home/coder/.config",
      "source": "${localWorkspaceFolder}/../.config"
    },
    {
      "type": "bind",
      "target": "/home/coder/rmm",
      "source": "${localWorkspaceFolder}/../rmm"
    },
    {
      "type": "bind",
      "target": "/home/coder/cudf",
      "source": "${localWorkspaceFolder}/../cudf"
    },
    {
      "type": "bind",
      "target": "/opt/rapids",
      "source": "${localWorkspaceFolder}/.devcontainer/opt/rapids"
    },
    {
      "type": "bind",
      "target": "/home/coder/workspace.code-workspace",
      "source": "${localWorkspaceFolder}/.devcontainer/home/coder/workspace.code-workspace"
    }
  ],

  "customizations": {
    "vscode": {
      "extensions": [
        "mutantdino.resourcemonitor",
        "tamasfe.even-better-toml"
      ],
      "settings": {
        "files.trimFinalNewlines": true,
        "files.insertFinalNewline": true,
        "files.trimTrailingWhitespace": true,
        "files.watcherExclude": {
          "**/target/**": true
        },
        "python.linting.flake8Enabled": true
      }
    }
  }
}
